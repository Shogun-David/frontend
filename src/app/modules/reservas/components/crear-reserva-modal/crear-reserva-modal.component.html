<div class="modal-header">
  <h5 class="modal-title">
    <i class="uil uil-plus-circle me-2"></i>
    Nueva Reserva
  </h5>

  <button type="button" class="btn-close" (click)="cancelar()"></button>
</div>

<div class="modal-body">
  <form [formGroup]="form">

    <!-- SALA -->
    <div class="mb-3">
      <label class="form-label">Sala</label>
      <select class="form-select" formControlName="idSala">
        <option value="">Seleccione</option>
        <option *ngFor="let sala of salas" [value]="sala.idSala">
          {{ sala.nombre }} - {{ sala.ubicacion }}
        </option>
      </select>
      <div class="text-danger small" *ngIf="form.get('idSala')?.touched && form.get('idSala')?.invalid">
        La sala es obligatoria
      </div>
    </div>

    <!-- FECHA INICIO -->
    <div class="mb-3">
      <label class="form-label">Fecha inicio</label>
      <input
        type="datetime-local"
        class="form-control"
        formControlName="fechaInicio"
        [min]="minFechaInicio"
      >
      <div class="text-danger small" *ngIf="form.get('fechaInicio')?.touched && form.get('fechaInicio')?.invalid">
        La fecha de inicio es obligatoria
      </div>
    </div>

    <!-- FECHA FIN -->
    <div class="mb-3">
      <label class="form-label">Fecha fin</label>
      <input
        type="datetime-local"
        class="form-control"
        formControlName="fechaFin"
        [min]="minFechaFin"
      >
      <div class="text-danger small" *ngIf="form.get('fechaFin')?.touched && form.get('fechaFin')?.invalid">
        La fecha de fin es obligatoria
      </div>
    </div>

    <!-- ERROR DE RANGO -->
    <div class="alert alert-danger py-1" *ngIf="form.errors?.['fechaFinInvalida']">
      La fecha fin debe ser mayor que la fecha inicio
    </div>

    <!-- NÚMERO DE ASISTENTES -->
    <div class="mb-3">
      <label class="form-label">Número de asistentes</label>

      <input
        type="number"
        class="form-control"
        formControlName="numeroAsistentes"
        min="1"
        step="1"
        oninput="this.value = this.value.replace(/[^0-9]/g, '')"
      />

      <div
        class="text-danger small"
        *ngIf="
          form.get('numeroAsistentes')?.touched &&
          form.get('numeroAsistentes')?.invalid
        "
      >
        <div *ngIf="form.get('numeroAsistentes')?.errors?.['required']">
          El número de asistentes es obligatorio
        </div>
        <div *ngIf="form.get('numeroAsistentes')?.errors?.['min']">
          Debe ser al menos 1 asistente
        </div>
      </div>
    </div>

    <!-- OBSERVACIÓN -->
    <div class="mb-3">
      <label class="form-label">Observación</label>
      <input
        type="text"
        class="form-control"
        formControlName="observacion"
        placeholder="Ej. Reunión mensual, capacitación, etc."
      >
    </div>

  </form>
</div>

<div class="modal-footer">
  <button class="btn btn-secondary" (click)="cancelar()">Cancelar</button>
  <button
    class="btn btn-primary"
    [disabled]="form.invalid || loading"
    (click)="guardar()"
  >
    Guardar
  </button>
</div>
